<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CredAi | Sign In</title>
    <link rel="icon" type="image/x-icon" href="assets/favicon.ico">
    <link rel="stylesheet" href="css/style.css">
    <script type="module" src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.esm.js"></script>

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
</head>

<body>
    <!-- NAVBAR -->
    <nav class="navbar">
        <div class="nav-container">
            <a href="index.html" class="nav-brand">CredAi</a>

            <div class="nav-actions">
                <a href="signup.html" class="btn btn-outline">Sign Up</a>
            </div>
        </div>
    </nav>

    <div class="container" style="padding-top: 140px; padding-bottom: 80px;">
        <div style="max-width: 480px; margin: 0 auto;">
            <div class="text-center" style="margin-bottom: 48px;">
                <p class="label-tag">Welcome Back</p>
                <h2 style="margin-top: 16px;">Sign In to CredAi</h2>
                <p style="color: var(--color-text-secondary); margin-top: 16px;">
                    Access your loan applications and credit evaluations
                </p>
            </div>

            <div class="feature-card glow-card">
                <form id="login-form">
                    <div class="form-group">
                        <label class="form-label">Email Address</label>
                        <input type="email" id="email" class="form-input" required placeholder="you@company.com">
                    </div>

                    <div class="form-group">
                        <label class="form-label">Password</label>
                        <input type="password" id="password" class="form-input" required
                            placeholder="Enter your password">
                    </div>

                    <div id="error-message"
                        style="display: none; padding: 12px; background: rgba(239, 68, 68, 0.1); border: 1px solid #EF4444; border-radius: var(--radius-lg); color: #EF4444; margin-bottom: 20px; font-size: 0.9rem;">
                    </div>

                    <button type="submit" class="btn btn-primary" style="width: 100%; margin-bottom: 20px;">
                        Sign In
                    </button>

                    <div style="text-align: center; color: var(--color-text-secondary); font-size: 0.9rem;">
                        Don't have an account?
                        <a href="signup.html"
                            style="color: var(--color-accent-purple); text-decoration: none; font-weight: 600;">
                            Sign Up
                        </a>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Firebase Scripts -->
    <script src="js/firebase-config.js"></script>
    <script src="js/auth.js"></script>
    <script>
        document.getElementById('login-form').addEventListener('submit', async (e) => {
            e.preventDefault();

            const email = document.getElementById('email').value;
            const password = document.getElementById('password').value;
            const submitBtn = e.target.querySelector('button[type="submit"]');
            const errorMsg = document.getElementById('error-message');

            // Hide previous errors
            errorMsg.style.display = 'none';

            // Show loading
            submitBtn.textContent = 'Signing In...';
            submitBtn.disabled = true;

            try {
                await window.authHelpers.signIn(email, password);

                // Redirect to dashboard
                window.location.href = 'dashboard.html';
            } catch (error) {
                console.error('Login error:', error);

                // Show error message
                let errorText = 'Failed to sign in. Please check your credentials.';
                if (error.code === 'auth/user-not-found') {
                    errorText = 'No account found with this email. Please sign up first.';
                } else if (error.code === 'auth/wrong-password') {
                    errorText = 'Incorrect password. Please try again.';
                } else if (error.code === 'auth/invalid-email') {
                    errorText = 'Invalid email address format.';
                }

                errorMsg.textContent = errorText;
                errorMsg.style.display = 'block';

                submitBtn.textContent = 'Sign In';
                submitBtn.disabled = false;
            }
        });

        // Redirect if already logged in
        auth.onAuthStateChanged((user) => {
            if (user) {
                // If on login page and already logged in, go to dashboard
                // But check if we just logged in vs page load
            }
        });
    </script>
    <script src="js/theme.js"></script>
    <script src="js/animations.js"></script>
</body>

</html>